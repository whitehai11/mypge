<!doctype html>
<html lang="de"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Flappy</title><link rel="stylesheet" href="../assets/styles.css"/></head>
<body><main class="page"><div class="container" style="align-items:stretch;max-width:820px;">
<h1 class="name"><span class="gradient-text">Flappy</span></h1>
<section class="card"><canvas id="c" width="480" height="260" class="vgame" style="width:100%;height:260px;display:block"></canvas><div class="muted">Space/W to flap</div></section>
<footer class="footer"><p>Â© <span id="y"></span> Maro</p></footer></div></main>
<script type="module">
import { unlockAchievement } from '../components/achievements.js';
unlockAchievement('flappy_pilot');
document.getElementById('y').textContent = new Date().getFullYear();
const c=document.getElementById('c'),x=c.getContext('2d'); let w=c.width,h=c.height; let y= h/2, v=0, g=0.35; let pipes=[]; let t=0; let alive=true; let score=0;
function addPipe(){ const gap=70; const top=20+Math.random()*(h-40-gap); pipes.push({x:w, top:top, bottom:top+gap}); }
function step(){ if(!alive) return; t++; if(t%90===0) addPipe(); v+=g; y+=v; if(y<0) y=0; if(y>h) alive=false; x.clearRect(0,0,w,h); x.fillStyle='rgba(0,0,0,.2)'; x.fillRect(0,0,w,h); x.fillStyle='#00ffc8'; x.beginPath(); x.arc(60,y,6,0,Math.PI*2); x.fill(); x.fillStyle='#aee7df';
  for(let i=0;i<pipes.length;i++){ const p=pipes[i]; p.x-=2; x.fillRect(p.x,0,20,p.top); x.fillRect(p.x,p.bottom,20,h-p.bottom); if(p.x+20<60 && !p.passed){ score++; p.passed=true; } if(60>p.x && 60<p.x+20 && (y< p.top || y> p.bottom)) alive=false; }
  pipes=pipes.filter(p=>p.x>-30); x.fillStyle='#aee7df'; x.fillText('Score '+score,6,14); requestAnimationFrame(step);
}
function start(){ addPipe(); step(); window.addEventListener('keydown',e=>{ if(e.code==='Space'||e.key==='w'||e.key==='W'){ v=-5; } }); }
window.addEventListener('terminal:interrupt', ()=>{ alive=false; });
const fs=document.createElement('div'); fs.style.cssText='position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.6);z-index:1005;color:#e5eef8;font:14px ui-monospace;'; fs.innerHTML='<div class="card" style="padding:12px 16px">Click to enter fullscreen and play</div>'; document.body.appendChild(fs); fs.addEventListener('click', async ()=>{ try{ await document.documentElement.requestFullscreen?.(); }catch(_){} fs.remove(); start(); });
 </script>
 <script type="module" src="../assets/version.js"></script>
 </body></html>
